[toc]

# 没有Visio能在Word和Markdown中插入矢量图吗？——drawio使用技巧总结

> 本文主要介绍drawio的使用技巧，不涉及具体的绘图教程和使用教程。



## 零	前言

作为程序员，我们在日常的工作中常常需要绘制各种各样的流程图、模型图。本科时期，我一直使用ProcessOn作为主要的绘图工具，其在线编辑的方式十分方便，无需下载软件即可绘制各式复杂的图形。但是，ProcessOn作为一款商业软件，具有使用容量的限制，绘制的图数量多了之后就只能选择删除过去的图或者付费使用。

在撰写毕业论文时，我在导师的推荐下使用了Visio作为绘图工具。微软出品的Visio功能强大，且绘制的矢量图可以直接拖拽到Word中，对论文写作帮助甚大。但是，Visio本身也是付费产品，尽管可以在网上寻找破解版，但终究麻烦。再者，Visio仅安装包就接近500MB，安装后占用的空间更是巨大。因此，我在论文答辩完之后，便十分开心地将其卸载了。

最近在改论文时，我的师姐推荐了drawio这一在线绘图工具。**其作为在线绘图工具，功能较之ProcessOn更为强大，且完全免费**，堪称绘图利器。在这些天的使用过程中，我也摸索到了一些drawio的使用技巧，在此分享给大家。



## 一	基本使用

### 1. 在线使用

如前文所言，drawio与ProcessOn一样，都是在线绘图工具。因此，我们可以通过访问[drawio的官网](https://app.diagrams.net/)在线绘制图片。绘制完成后，我们可以将其导出为各种格式的图片文件。值得注意的是，**drawio导出的png图片（可编辑位图）和svg图片（可编辑矢量图），都是可以再次通过drawio官网再次打开进行编辑的。**

### 2. 下载软件使用

通过浏览器打开drawio的官网虽然很方便，但是却不能直接关联打开drawio文件。因此，我们也可以使用官网提供的[下载链接](https://github.com/jgraph/drawio-desktop/releases)安装drawio，安装后可关联打开drawio文件。经过测试，**drawio可以正常打开drawio文件和（使用drawio导出的）png文件，但是drawio无法打开svg文件。**

### 3. 通过vscode插件使用（推荐）

如果电脑上安装了vscode，那么我们也可以使用vscode上的一款drawio插件——Draw.io Integration。

这款插件能让我们在vscode上使用drawio进行绘图，更重要的是，其修复了官方软件不能编辑svg文件的bug。也就是说，**使用这款插件之后，我们就能使用vscode打开drawio文件、png文件和svg文件进行编辑了。**当然，前提是png文件和svg文件本身就是由drawio导出，或是直接在vscode上新建的文件。



## 二	在Markdown使用drawio图片

在[《Mermaid从入门到入土——Markdown进阶语法》](https://zhuanlan.zhihu.com/p/355997933)中一文，我详细介绍了在markdown中如何使用Mermaid绘制简单的图像。Mermaid作为一款基于JavaScript的自动绘图工具，可以让用户通过简单的代码绘制图像。由于Mermaid通过渲染器自动生成图像，因此用户不需要像传统绘图工具那样手动调整图元素的位置，只需要关注图元素的内容即可。

然而，正是由于其自动生成的特性，我们无法根据我们的想法调整图结构。同时，Mermaid绘制简单图形时尚可一用，但如果图结构复杂起来，渲染器生成的图像就不是十分美观了。

所幸，有了drawio之后，我们就能在markdown中插入美观的复杂图形了。**我们只需要将drawio绘制的png图片或svg图片的路径添加到我们的markdown笔记中，编辑器即可将其展示出来。**

笔者所使用的markdown编辑器Typora，支持在插入图片时将图片复制到指定路径。我设置的路径是`./md_assets/${filename}`，即将图片复制到文件同级目录下的md_assets文件夹中的，与笔记同名的子文件夹中。

> 假设我有一个名为test.md的文件，那么其图片保存于下面的test文件夹中。
>
> │  test.md
> │
> └─md_assets
>     └─test

由于drawio可以再次编辑其导出的png或svg文件，因此我们就能动态更新笔记中的图形了。不过，**svg矢量图文件比png标量图文件的显示效果好很多，因此最好在markdown中插入svg矢量图文件。**



## 三	在Word中使用drawio图片

同理，我们也可以在Word中插入svg和png文件。**不过由于Word并不是通过引用方式使用图片，而是将图片直接插入到docx文件中，因此我们无法动态更新图形。**svg、png图片插入到Word中时已经损失了所有的编辑信息，即使导出图片，也无法再通过drawio再次编辑了。

**所以，如果Word中使用了drawio绘制的图形，一定要保留图片源文件，方便二次修改。**

此外，笔者整理了一些在Word中插入图片的注意事项，如下：

1. 插入矢量图（svg）：**svg文件直接插入到word中会出现“does not support full SVG 1.1”的字样，我们可以使用文本编辑器修改svg文件，将源码中的“Viewer does not support full SVG 1.1”去掉**，来解决这个问题。

   - 优点：矢量图十分清晰。

   - 缺点：svg图片在word中的显示有时会与drawio不一致。

   > “does not support full SVG 1.1”的问题有诸多解决方案，这里我使用的是最简单的一种方案，其他方案可自行搜索。

2. 插入位图（png）：**默认导出的png图片清晰度极低，解决方案是将导出选项中的Zoom设置得高一些**，不过Zoom设置得再高位图的清晰度也比不上矢量图。

   - 优点：png图片的显示结果在word与drawio中总是保持一致。

   - 缺点：位图的显示效果比矢量图差。

---

当然，**如果仅仅需要简单的流程图，也可以使用PPT直接绘制，然后将图片拖拽进Word之中。**PPT绘制的图也是矢量图，显示清晰且支持二次修改。